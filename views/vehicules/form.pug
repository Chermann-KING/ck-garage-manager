extends ../layout

block content
  .row
    .col-md-8.offset-md-2
      .card.mb-4
        .card-header.bg-success.text-white
          i.bi.bi-car-front-fill.me-2
          | #{isNew ? 'Ajouter un véhicule' : 'Modifier un véhicule'}
      
        .card-body
          if error
            .alert.alert-danger.mb-4
              i.bi.bi-exclamation-triangle-fill.me-2
              | #{error}
          
          form(method="POST", action="/vehicules/ajouter")
            .mb-3
              label.form-label(for="clientId") Propriétaire *
              select#clientId.form-select(name="clientId", required)
                option(value="", disabled, selected=!vehicule.ClientID) Sélectionnez un client
                each client in clients
                  option(value=client.ClientID, selected=vehicule.ClientID == client.ClientID) #{client.Prenom} #{client.Nom}
            
            .row.mb-3
              .col-md-6
                label.form-label(for="marque") Marque *
                input#marque.form-control(type="text", name="marque", value=vehicule.Marque || '', required)
              .col-md-6
                label.form-label(for="modele") Modèle *
                input#modele.form-control(type="text", name="modele", value=vehicule.Modele || '', required)
            
            .row.mb-3
              .col-md-6
                label.form-label(for="immatriculation") Immatriculation *
                input#immatriculation.form-control(type="text", name="immatriculation", value=vehicule.Immatriculation || '', required)
              .col-md-6
                label.form-label(for="annee") Année
                input#annee.form-control(type="number", name="annee", min="1900", max="2100", value=vehicule.Annee || '')
            
            if selectedClient
              .form-check.mb-3
                input#returnToClient.form-check-input(type="checkbox", name="returnToClient", value="1", checked)
                label.form-check-label(for="returnToClient") Retourner à la fiche client après l'ajout
                input(type="hidden", name="clientIdRedirect", value=selectedClient.ClientID)
            
            .d-flex.justify-content-between.mt-4
              a.btn.btn-secondary(href=selectedClient ? `/clients/${selectedClient.ClientID}` : "/vehicules")
                i.bi.bi-x-circle.me-2
                | Annuler
              button.btn.btn-success(type="submit")
                i.bi.bi-check-circle.me-2
                | Ajouter le véhicule